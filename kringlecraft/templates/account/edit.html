{# /account/edit #}
{% extends 'shared/_layout.html' %}

{% block title %}Edit Account{% endblock %}

{% block modal %}
    {# Modal dialog window - delete currently logged in user #}
    <div id="myModalDelete" class="modal fade" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Delete Account</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="{{ url_for('account.edit_deletion_post') }}" method="POST" id="form_deletion">
                        {{ deletion_form.csrf_token }}
                        Are you sure?
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger mt-4 btn-space" form="form_deletion"><i class="bi bi-check"></i> Confirm</button>
                    <button type="button" class="btn btn-secondary mt-4 btn-space" data-bs-dismiss="modal"><i class="bi bi-x"></i> Cancel</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div class="container-fluid c-restricted-md c-header rounded bg-light mt-4 pt-4 pb-4">
        <div class="container-fluid c-restricted-sm">
            {# Display form and possible error message - change user data #}
            <div class="mb-3 fs-4">Edit Account</div>
            <form action="{{ url_for('account.edit_mail_post') }}" method="POST">
                {{ mail_form.csrf_token }}
                <div class="form-group mt-2 mb-2">
                    <label for="email">{{ mail_form.email.label }}</label>
                    {{ mail_form.email(size=20, class="form-control", onkeypress="return event.charCode != 32") }}
                </div>
                {% for error in mail_form.email.errors %}
                    <div class="alert alert-warning"><strong>Warning!</strong> {{ error }}</div>
                {% endfor %}
                <div class="form-group mt-2 mb-2">
                    <label for="description">{{ mail_form.description.label }}</label>
                    {{ mail_form.description(size=40, class="form-control") }}
                </div>
                {% for error in mail_form.description.errors %}
                    <div class="alert alert-warning"><strong>Warning!</strong> {{ error }}</div>
                {% endfor %}
                <div class="form-check mt-2 mb-2">
                    <label class="form-check-label" for="notification">{{ mail_form.notification.label }}</label>
                    {{ mail_form.notification(class="form-check-input") }}
                </div>
                {% for error in mail_form.notification.errors %}
                    <div class="alert alert-warning"><strong>Warning!</strong> {{ error }}</div>
                {% endfor %}
                <button type="submit" class="btn btn-primary mt-4"><i class="bi bi-save2"></i>  Update Data</button>
            </form>
        </div>
    </div>

    <div class="container-fluid c-restricted-md c-header rounded bg-light mt-4 pt-4 pb-4">
        <div class="container-fluid c-restricted-sm">
            {# Display form and possible error message - set a password for currently logged in user #}
            <div class="mb-3 fs-4">Set new password</div>
            <form action="{{ url_for('account.edit_password_post') }}" method="POST">
                {{ password_form.csrf_token }}
                <div class="form-group mt-2 mb-2">
                    <label for="password">{{ password_form.password.label }}</label>
                    {{ password_form.password(size=20, class="form-control") }}
                </div>
                {% for error in password_form.password.errors %}
                    <div class="alert alert-warning"><strong>Warning!</strong> {{ error }}</div>
                {% endfor %}
                <div class="form-group mt-2 mb-2">
                    <label for="password2">{{ password_form.password2.label }}</label>
                    {{ password_form.password2(size=20, class="form-control") }}
                </div>
                <button type="submit" class="btn btn-primary mt-4"><i class="bi bi-save"></i> Set Password</button>
            </form>
        </div>
    </div>

    <div class="container-fluid c-restricted-md c-header rounded bg-light mt-4 pt-4 pb-4">
        <div class="container-fluid c-restricted-sm">
            {# Display simple button - show modal dialog window to delete currently logged in user #}
            <div class="mb-3 fs-4">Delete this user account</div>
            <button type="button" class="btn btn-danger mt-4" data-bs-toggle="modal" data-bs-target="#myModalDelete"><i class="bi bi-trash"></i> Delete Account</button>
        </div>
    </div>
{% endblock %}
